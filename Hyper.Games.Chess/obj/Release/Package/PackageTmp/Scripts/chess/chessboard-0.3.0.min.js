/*!
 * chessboard.js v0.3.0
 *
 * Copyright 2013 Chris Oakman
 * Released under the MIT license
 * http://chessboardjs.com/license
 *
 * Date: 10 Aug 2013
 */
(function(){"use strict";function e(t){if(typeof t!="string")return!1;var i=t.split("-");return i.length!==2?!1:n(i[0])===!0&&n(i[1])===!0}function n(n){return typeof n!="string"?!1:n.search(/^[a-h][1-8]$/)!==-1}function o(n){return typeof n!="string"?!1:n.search(/^[bw][KQRNBP]$/)!==-1}function f(n){var i,t;if(typeof n!="string"||(n=n.replace(/ .+$/,""),i=n.split("/"),i.length!==8))return!1;for(t=0;t<8;t++)if(i[t]===""||i[t].length>8||i[t].search(/[^kqrbnpKQRNBP1-8]/)!==-1)return!1;return!0}function i(t){if(typeof t!="object")return!1;for(var i in t)if(t.hasOwnProperty(i)===!0&&(n(i)!==!0||o(t[i])!==!0))return!1;return!0}function s(n){return n.toLowerCase()===n?"b"+n.toUpperCase():"w"+n.toUpperCase()}function h(n){var t=n.split("");return t[0]==="w"?t[1].toUpperCase():t[1].toLowerCase()}function r(n){var u,r,e,i,c,l;if(f(n)!==!0)return!1;n=n.replace(/ .+$/,"");var a=n.split("/"),o={},h=8;for(u=0;u<8;u++){for(r=a[u].split(""),e=0,i=0;i<r.length;i++)r[i].search(/[1-8]/)!==-1?(c=parseInt(r[i],10),e+=c):(l=t[e]+h,o[l]=s(r[i]),e++);h--}return o}function u(n){var r,e,u,f,o;if(i(n)!==!0)return!1;for(r="",e=8,u=0;u<8;u++){for(f=0;f<8;f++)o=t[f]+e,r+=n.hasOwnProperty(o)===!0?h(n[o]):"1";u!==7&&(r+="/");e--}return r=r.replace(/11111111/g,"8"),r=r.replace(/1111111/g,"7"),r=r.replace(/111111/g,"6"),r=r.replace(/11111/g,"5"),r=r.replace(/1111/g,"4"),r=r.replace(/111/g,"3"),r.replace(/11/g,"2")}var t="abcdefgh".split("");window.ChessBoard=window.ChessBoard||function(o,s){function rt(){return"xxxx-xxxx-xxxx-xxxx-xxxx-xxxx-xxxx-xxxx".replace(/x/g,function(){var n=Math.random()*16|0;return n.toString(16)})}function l(n){return JSON.parse(JSON.stringify(n))}function ni(n){var t=n.split(".");return{major:parseInt(t[0],10),minor:parseInt(t[1],10),patch:parseInt(t[2],10)}}function oi(n,t){n=ni(n);t=ni(t);var i=n.major*1e8+n.minor*1e4+n.patch,r=t.major*1e8+t.minor*1e4+t.patch;return i>=r}function et(n,t,i){if(s.hasOwnProperty("showErrors")===!0&&s.showErrors!==!1){var r="ChessBoard Error "+n+": "+t;if(s.showErrors==="console"&&typeof console=="object"&&typeof console.log=="function"){console.log(r);arguments.length>=2&&console.log(i);return}if(s.showErrors==="alert"){i&&(r+="\n\n"+JSON.stringify(i));window.alert(r);return}typeof s.showErrors=="function"&&s.showErrors(n,t,i)}}function si(){if(typeof o=="string"){if(o==="")return window.alert("ChessBoard Error 1001: The first argument to ChessBoard() cannot be an empty string.\n\nExiting..."),!1;var n=document.getElementById(o);if(!n)return window.alert('ChessBoard Error 1002: Element with id "'+o+'" does not exist in the DOM.\n\nExiting...'),!1;w=$(n)}else if(w=$(o),w.length!==1)return window.alert("ChessBoard Error 1003: The first argument to ChessBoard() must be an ID or a single DOM node.\n\nExiting..."),!1;return!window.JSON||typeof JSON.stringify!="function"||typeof JSON.parse!="function"?(window.alert("ChessBoard Error 1004: JSON does not exist. Please include a JSON polyfill.\n\nExiting..."),!1):(typeof $&&$.fn&&$.fn.jquery&&oi($.fn.jquery,bt)===!0)?!0:(window.alert("ChessBoard Error 1005: Unable to find a valid version of jQuery. Please include jQuery "+bt+" or higher on the page.\n\nExiting..."),!1)}function ot(n){return n==="fast"||n==="slow"?!0:parseInt(n,10)+""!=n+""?!1:n>=0}function hi(){return(typeof s=="string"||i(s)===!0)&&(s={position:s}),s.orientation!=="black"&&(s.orientation="white"),b=s.orientation,s.showNotation!==!1&&(s.showNotation=!0),s.draggable!==!0&&(s.draggable=!1),s.dropOffBoard!=="trash"&&(s.dropOffBoard="snapback"),s.sparePieces!==!0&&(s.sparePieces=!1),s.sparePieces===!0&&(s.draggable=!0),(s.hasOwnProperty("pieceTheme")!==!0||typeof s.pieceTheme!="string"&&typeof s.pieceTheme!="function")&&(s.pieceTheme="/Content/img/chess/{piece}.png"),(s.hasOwnProperty("appearSpeed")!==!0||ot(s.appearSpeed)!==!0)&&(s.appearSpeed=200),(s.hasOwnProperty("moveSpeed")!==!0||ot(s.moveSpeed)!==!0)&&(s.moveSpeed=200),(s.hasOwnProperty("snapbackSpeed")!==!0||ot(s.snapbackSpeed)!==!0)&&(s.snapbackSpeed=50),(s.hasOwnProperty("snapSpeed")!==!0||ot(s.snapSpeed)!==!0)&&(s.snapSpeed=25),(s.hasOwnProperty("trashSpeed")!==!0||ot(s.trashSpeed)!==!0)&&(s.trashSpeed=100),s.hasOwnProperty("position")===!0&&(s.position==="start"?c=l(kt):f(s.position)===!0?c=r(s.position):i(s.position)===!0?c=l(s.position):et(7263,"Invalid value passed to config.position.",s.position)),!0}function ci(){var t=parseInt(w.css("width"),10),n;if(!t||t<=0)return 0;for(n=t-1;n%8!=0&&n>0;)n--;return n/8}function li(){for(var i,u,r,f,e,n=0;n<t.length;n++)for(i=1;i<=8;i++)u=t[n]+i,v[u]=u+"-"+rt();for(r="KQRBNP".split(""),n=0;n<r.length;n++)f="w"+r[n],e="b"+r[n],st[f]=f+"-"+rt(),st[e]=e+"-"+rt()}function ai(){var n='<div class="'+h.chessboard+'">';return s.sparePieces===!0&&(n+='<div class="'+h.sparePieces+" "+h.sparePiecesTop+'"><\/div>'),n+='<div class="'+h.board+'"><\/div>',s.sparePieces===!0&&(n+='<div class="'+h.sparePieces+" "+h.sparePiecesBottom+'"><\/div>'),n+"<\/div>"}function vi(n){var u,c,f,e;n!=="black"&&(n="white");var i="",o=l(t),r=8;for(n==="black"&&(o.reverse(),r=1),u="white",c=0;c<8;c++){for(i+='<div class="'+h.row+'">',f=0;f<8;f++)e=o[f]+r,i+='<div class="'+h.square+" "+h[u]+" square-"+e+'" style="width: '+y+"px; height: "+y+'px" id="'+v[e]+'" data-square="'+e+'">',s.showNotation===!0&&((n==="white"&&r===1||n==="black"&&r===8)&&(i+='<div class="'+h.notation+" "+h.alpha+'">'+o[f]+"<\/div>"),f===0&&(i+='<div class="'+h.notation+" "+h.numeric+'">'+r+"<\/div>")),i+="<\/div>",u=u==="white"?"black":"white";i+='<div class="'+h.clearfix+'"><\/div><\/div>';u=u==="white"?"black":"white";n==="white"?r--:r++}return i}function ti(n){return typeof s.pieceTheme=="function"?s.pieceTheme(n):typeof s.pieceTheme=="string"?s.pieceTheme.replace(/{piece}/g,n):(et(8272,"Unable to build image source for cfg.pieceTheme."),"")}function tt(n,t,i){var r='<img src="'+ti(n)+'" ';return i&&typeof i=="string"&&(r+='id="'+i+'" '),r+='alt="" class="'+h.piece+'" data-piece="'+n+'" style="width: '+y+"px;height: "+y+"px;",t===!0&&(r+="display:none;"),r+'" />'}function ht(n){var i=["wK","wQ","wR","wB","wN","wP"],r,t;for(n==="black"&&(i=["bK","bQ","bR","bB","bN","bP"]),r="",t=0;t<i.length;t++)r+=tt(i[t],!1,st[i[t]]);return r}function yi(n,t,i,r){var f=$("#"+v[n]),e=f.offset(),o=$("#"+v[t]),y=o.offset(),c=rt(),u,l,a;$("body").append(tt(i,!0,c));u=$("#"+c);u.css({display:"",position:"absolute",top:e.top,left:e.left});f.find("."+h.piece).remove();l=function(){o.append(tt(i));u.remove();typeof r=="function"&&r()};a={duration:s.moveSpeed,complete:l};u.animate(y,a)}function pi(n,t,i){var f=$("#"+st[n]).offset(),u=$("#"+v[t]),l=u.offset(),e=rt(),r,o,c;$("body").append(tt(n,!0,e));r=$("#"+e);r.css({display:"",position:"absolute",left:f.left,top:f.top});o=function(){u.find("."+h.piece).remove();u.append(tt(n));r.remove();typeof i=="function"&&i()};c={duration:s.moveSpeed,complete:o};r.animate(l,c)}function wi(n,t,i){function u(){if((f++,f===n.length)&&(ut(),dt=!1,s.hasOwnProperty("onMoveEnd")===!0&&typeof s.onMoveEnd=="function"))s.onMoveEnd(l(t),l(i))}var f,r;for(dt=!0,f=0,r=0;r<n.length;r++)n[r].type==="clear"&&$("#"+v[n[r].square]+" ."+h.piece).fadeOut(s.trashSpeed,u),n[r].type==="add"&&s.sparePieces!==!0&&$("#"+v[n[r].square]).append(tt(n[r].piece,!0)).find("."+h.piece).fadeIn(s.appearSpeed,u),n[r].type==="add"&&s.sparePieces===!0&&pi(n[r].piece,n[r].square,u),n[r].type==="move"&&yi(n[r].source,n[r].destination,n[r].piece,u)}function bi(n,i){var r,u;n=n.split("");r=t.indexOf(n[0])+1;u=parseInt(n[1],10);i=i.split("");var o=t.indexOf(i[0])+1,s=parseInt(i[1],10),f=Math.abs(r-o),e=Math.abs(u-s);return f>=e?f:e}function ki(n){for(var u,f,e,r=[],i=0;i<8;i++)for(u=0;u<8;u++)(f=t[i]+(u+1),n!==f)&&r.push({square:f,distance:bi(n,f)});for(r.sort(function(n,t){return n.distance-t.distance}),e=[],i=0;i<r.length;i++)e.push(r[i].square);return e}function di(n,t,i){for(var r,f=ki(i),u=0;u<f.length;u++)if(r=f[u],n.hasOwnProperty(r)===!0&&n[r]===t)return r;return!1}function gi(n,t){var r,f,u,i;n=l(n);t=l(t);r=[];f={};for(i in t)t.hasOwnProperty(i)===!0&&n.hasOwnProperty(i)===!0&&n[i]===t[i]&&(delete n[i],delete t[i]);for(i in t)t.hasOwnProperty(i)===!0&&(u=di(n,t[i],i),u!==!1&&(r.push({type:"move",source:u,destination:i,piece:t[i]}),delete n[u],delete t[i],f[i]=!0));for(i in t)t.hasOwnProperty(i)===!0&&(r.push({type:"add",square:i,piece:t[i]}),delete t[i]);for(i in n)n.hasOwnProperty(i)===!0&&f.hasOwnProperty(i)!==!0&&(r.push({type:"clear",square:i,piece:n[i]}),delete n[i]);return r}function ut(){k.find("."+h.piece).remove();for(var n in c)c.hasOwnProperty(n)===!0&&$("#"+v[n]).append(tt(c[n]))}function yt(){k.html(vi(b));ut();s.sparePieces===!0&&(b==="white"?(at.html(ht("black")),vt.html(ht("white"))):(at.html(ht("white")),vt.html(ht("black"))))}function nr(n,t){var i,r;n=l(n);for(i in t)t.hasOwnProperty(i)===!0&&n.hasOwnProperty(i)===!0&&(r=n[i],delete n[i],n[t[i]]=r);return n}function ct(n){var t=l(c),i=l(n),r=u(t),f=u(i);if(r!==f){if(s.hasOwnProperty("onChange")===!0&&typeof s.onChange=="function")s.onChange(t,i);c=n}}function pt(n,t){var r,i;for(r in ft)if(ft.hasOwnProperty(r)===!0&&(i=ft[r],n>=i.left&&n<i.left+y&&t>=i.top&&t<i.top+y))return r;return"offboard"}function tr(){ft={};for(var n in v)v.hasOwnProperty(n)===!0&&(ft[n]=$("#"+v[n]).offset())}function wt(){k.find("."+h.square).removeClass(h.highlight1+" "+h.highlight2)}function ir(){function n(){if(ut(),d.css("display","none"),s.hasOwnProperty("onSnapbackEnd")===!0&&typeof s.onSnapbackEnd=="function")s.onSnapbackEnd(nt,p,l(c),b)}if(p==="spare"){ii();return}wt();var t=$("#"+v[p]).offset(),i={duration:s.snapbackSpeed,complete:n};d.animate(t,i);g=!1}function ii(){wt();var n=l(c);delete n[p];ct(n);ut();d.fadeOut(s.trashSpeed);g=!1}function rr(n){var t;wt();t=l(c);delete t[p];t[n]=nt;ct(t);var i=$("#"+v[n]).offset(),r=function(){if(ut(),d.css("display","none"),s.hasOwnProperty("onSnapEnd")===!0&&typeof s.onSnapEnd=="function")s.onSnapEnd(p,n,nt)},u={duration:s.snapSpeed,complete:r};d.animate(i,u);g=!1}function lt(n,t,i,r){(typeof s.onDragStart!="function"||s.onDragStart(n,t,l(c),b)!==!1)&&(g=!0,nt=t,p=n,it=n==="spare"?"offboard":n,tr(),d.attr("src",ti(t)).css({display:"",position:"absolute",left:i-y/2,top:r-y/2}),n!=="spare"&&$("#"+v[n]).addClass(h.highlight1).find("."+h.piece).css("display","none"))}function ri(t,i){d.css({left:t-y/2,top:i-y/2});var r=pt(t,i);if(r!==it){if(n(it)===!0&&$("#"+v[it]).removeClass(h.highlight2),n(r)===!0&&$("#"+v[r]).addClass(h.highlight2),typeof s.onDragMove=="function")s.onDragMove(r,it,p,nt,l(c),b);it=r}}function ui(t){var i="drop",r,f,u;t==="offboard"&&s.dropOffBoard==="snapback"&&(i="snapback");t==="offboard"&&s.dropOffBoard==="trash"&&(i="trash");s.hasOwnProperty("onDrop")===!0&&typeof s.onDrop=="function"&&(r=l(c),p==="spare"&&n(t)===!0&&(r[t]=nt),n(p)===!0&&t==="offboard"&&delete r[p],n(p)===!0&&n(t)===!0&&(delete r[p],r[t]=nt),f=l(c),u=s.onDrop(p,t,nt,r,f,b),(u==="snapback"||u==="trash")&&(i=u));i==="snapback"?ir():i==="trash"?ii():i==="drop"&&rr(t)}function ur(){return"ontouchstart"in document.documentElement}function fr(){return navigator&&navigator.userAgent&&navigator.userAgent.search(/MSIE/)!==-1}function er(n){n.preventDefault()}function or(t){if(s.draggable===!0){var i=$(this).attr("data-square");n(i)===!0&&c.hasOwnProperty(i)===!0&&lt(i,c[i],t.pageX,t.pageY)}}function sr(t){if(s.draggable===!0){var i=$(this).attr("data-square");n(i)===!0&&c.hasOwnProperty(i)===!0&&(t=t.originalEvent,lt(i,c[i],t.changedTouches[0].pageX,t.changedTouches[0].pageY))}}function hr(n){if(s.sparePieces===!0){var t=$(this).attr("data-piece");lt("spare",t,n.pageX,n.pageY)}}function cr(n){if(s.sparePieces===!0){var t=$(this).attr("data-piece");n=n.originalEvent;lt("spare",t,n.changedTouches[0].pageX,n.changedTouches[0].pageY)}}function fi(n){g===!0&&ri(n.pageX,n.pageY)}function lr(n){g===!0&&(n.preventDefault(),ri(n.originalEvent.changedTouches[0].pageX,n.originalEvent.changedTouches[0].pageY))}function ei(n){if(g===!0){var t=pt(n.pageX,n.pageY);ui(t)}}function ar(n){if(g===!0){var t=pt(n.originalEvent.changedTouches[0].pageX,n.originalEvent.changedTouches[0].pageY);ui(t)}}function vr(t){var i,r;if(g===!1&&s.hasOwnProperty("onMouseoverSquare")===!0&&typeof s.onMouseoverSquare=="function"&&(i=$(t.currentTarget).attr("data-square"),n(i)===!0)){r=!1;c.hasOwnProperty(i)===!0&&(r=c[i]);s.onMouseoverSquare(i,r,l(c),b)}}function yr(t){var i,r;if(g===!1&&s.hasOwnProperty("onMouseoutSquare")===!0&&typeof s.onMouseoutSquare=="function"&&(i=$(t.currentTarget).attr("data-square"),n(i)===!0)){r=!1;c.hasOwnProperty(i)===!0&&(r=c[i]);s.onMouseoutSquare(i,r,l(c),b)}}function pr(){$("body").on("mousedown mousemove","."+h.piece,er);k.on("mousedown","."+h.square,or);w.on("mousedown","."+h.sparePieces+" ."+h.piece,hr);k.on("mouseenter","."+h.square,vr);k.on("mouseleave","."+h.square,yr);if(fr()===!0){document.ondragstart=function(){return!1};$("body").on("mousemove",fi);$("body").on("mouseup",ei)}else{$(window).on("mousemove",fi);$(window).on("mouseup",ei)}if(ur()===!0){k.on("touchstart","."+h.square,sr);w.on("touchstart","."+h.sparePieces+" ."+h.piece,cr);$(window).on("touchmove",lr);$(window).on("touchend",ar)}}function wr(){w.html(ai());k=w.find("."+h.board);s.sparePieces===!0&&(at=w.find("."+h.sparePiecesTop),vt=w.find("."+h.sparePiecesBottom));var n=rt();$("body").append(tt("wP",!0,n));d=$("#"+n);gt=parseInt(k.css("borderLeftWidth"),10);a.resize()}function br(){si()===!0&&hi()===!0&&(li(),wr(),pr())}s=s||{};var bt="1.7.0",kt=r("rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR"),h={alpha:"alpha-d2270",black:"black-3c85d",board:"board-b72b1",chessboard:"chessboard-63f37",clearfix:"clearfix-7da63",highlight1:"highlight1-32417",highlight2:"highlight2-9c5d2",notation:"notation-322f9",numeric:"numeric-fc462",piece:"piece-417db",row:"row-5277c",sparePieces:"spare-pieces-7492f",sparePiecesBottom:"spare-pieces-bottom-ae20f",sparePiecesTop:"spare-pieces-top-4028b",square:"square-55d63",white:"white-1e1d7"},w,k,d,at,vt,a={},dt=!1,gt=2,b="white",c={},y,nt,it,p,g=!1,st={},v={},ft;return a.clear=function(n){a.position({},n)},a.destroy=function(){w.html("");d.remove();w.unbind()},a.fen=function(){return a.position("fen")},a.flip=function(){a.orientation("flip")},a.move=function(){var t,i,n,r,u;if(arguments.length!==0){for(t=!0,i={},n=0;n<arguments.length;n++){if(arguments[n]===!1){t=!1;continue}if(e(arguments[n])!==!0){et(2826,"Invalid move passed to the move method.",arguments[n]);continue}r=arguments[n].split("-");i[r[0]]=r[1]}return u=nr(c,i),a.position(u,t),u}},a.orientation=function(n){if(arguments.length===0)return b;if(n==="white"||n==="black"){b=n;yt();return}if(n==="flip"){b=b==="white"?"black":"white";yt();return}et(5482,"Invalid value passed to the orientation method.",n)},a.position=function(n,t){if(arguments.length===0)return l(c);if(typeof n=="string"&&n.toLowerCase()==="fen")return u(c);if(t!==!1&&(t=!0),typeof n=="string"&&n.toLowerCase()==="start"&&(n=l(kt)),f(n)===!0&&(n=r(n)),i(n)!==!0){et(6482,"Invalid value passed to the position method.",n);return}t===!0?(wi(gi(c,n),c,n),ct(n)):(ct(n),ut())},a.resize=function(){y=ci();k.css("width",y*8+"px");d.css({height:y,width:y});s.sparePieces===!0&&w.find("."+h.sparePieces).css("paddingLeft",y+gt+"px");yt()},a.start=function(n){a.position("start",n)},br(),a};window.ChessBoard.fenToObj=r;window.ChessBoard.objToFen=u})();
//# sourceMappingURL=chessboard-0.3.0.min.js.map
